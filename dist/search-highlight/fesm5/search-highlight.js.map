{"version":3,"file":"search-highlight.js.map","sources":["ng://search-highlight/lib/search-highlight.service.ts","ng://search-highlight/lib/components/search-highlight/search-highlight.component.ts","ng://search-highlight/lib/adf.module.ts","ng://search-highlight/lib/search-highlight.module.ts"],"sourcesContent":["/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchHighlightService {\n\n  constructor() {}\n  \n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit, Input, ViewEncapsulation, OnDestroy, TemplateRef } from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\n\nimport { takeUntil } from 'rxjs/operators';\nimport { MinimalNodeEntity } from '@alfresco/js-api';\nimport { Store } from '@ngrx/store';\nimport { Router } from '@angular/router';\nimport { ViewNodeAction, NavigateToFolder } from '@alfresco/aca-shared/store';\n\n\n@Component({\n  selector: 'aca-search-results-row-highlight',\n  encapsulation: ViewEncapsulation.None,\n  templateUrl: './search-highlight.component.html',\n  styleUrls: ['./search-highlight.component.scss']\n})\nexport class SearchHighlightComponent implements OnInit, OnDestroy {\n\n  @Input()\n  context: any;\n\n  @Input()\n  locationField: TemplateRef<any>;\n\n  private node: MinimalNodeEntity;\n  private onDestroy$ = new Subject<boolean>();\n  name$ = new BehaviorSubject<string>('');\n  title$ = new BehaviorSubject<string>('');\n  highlight: [];\n\n  constructor(\n    private store: Store<any>,\n    private alfrescoApiService: AlfrescoApiService,\n    private router: Router\n    ) { }\n\n  ngOnInit() {\n    \n    this.updateValues();\n\n    this.alfrescoApiService.nodeUpdated\n      .pipe(takeUntil(this.onDestroy$))\n      .subscribe((node: any) => {\n        const row = this.context.row;\n        if (row) {\n          const { entry } = row.node;\n\n          if (entry.id === node.id) {\n            entry.name = node.name;\n            entry.properties = Object.assign({}, node.properties);\n            entry.search = Object.assign({}, node.search);\n            this.updateValues();\n          }\n        }\n      });\n  }\n\n  private updateValues() {\n\n    this.node = this.context.row.node;\n\n    const highlightAll = (this.node.entry['search'] && this.node.entry['search']['highlight']) ? this.node.entry['search']['highlight'] : [];\n\n    const { name, properties } = this.node.entry;\n    const title = properties ? properties['cm:title'] : '';\n\n    this.name$.next(name);\n\n    if (title !== name) {\n      this.title$.next(title ? `( ${title} )` : '');\n    }\n\n    highlightAll.forEach(elem => {\n      if (elem.field === \"cm:name\") {\n        this.name$.next(elem.snippets[0]);\n      }\n\n      if (elem.field === \"cm:title\" && title !== name) {\n        this.title$.next(`( ${elem.snippets[0]} )`);\n      }\n\n      if (elem.field === \"cm:content\") {\n        this.highlight = elem.snippets;\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.onDestroy$.next(true);\n    this.onDestroy$.complete();\n  }\n\n  get description(): string {\n    const { properties } = this.node.entry;\n    return properties ? properties['cm:description'] : '';\n  }\n\n  get modifiedAt(): Date {\n    return this.node.entry.modifiedAt;\n  }\n\n  get size(): number {\n    const { content } = this.node.entry;\n    return content ? content.sizeInBytes : null;\n  }\n\n  get user(): string {\n    return this.node.entry.modifiedByUser.displayName;\n  }\n\n  get isFile(): boolean {\n    return this.node.entry.isFile;\n  }\n\n  showPreview(event: MouseEvent) {\n    event.stopPropagation();\n    this.store.dispatch(\n      new ViewNodeAction(this.node.entry.id, { location: this.router.url })\n    );\n  }\n\n  navigate(event: MouseEvent) {\n    event.stopPropagation();\n    this.store.dispatch(new NavigateToFolder(this.node));\n  }\n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\n// ADF modules\nimport {\n  CoreModule,\n  PipeModule,\n  ToolbarModule,\n  DirectiveModule\n} from '@alfresco/adf-core';\n\nexport function modules() {\n  return [CoreModule, ToolbarModule, PipeModule, DirectiveModule];\n}\n\n@NgModule({\n  imports: modules(),\n  exports: modules()\n})\nexport class AdfModule {\n\n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { SearchHighlightComponent } from './components/search-highlight/search-highlight.component';\nimport { CommonModule } from '@angular/common';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { AdfModule } from './adf.module';\n\n@NgModule({\n  declarations: [SearchHighlightComponent],\n  imports: [CommonModule, BrowserModule, TranslateModule.forChild(), AdfModule],\n  exports: [SearchHighlightComponent],\n  entryComponents: [SearchHighlightComponent],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class SearchHighlightModule { }\n"],"names":[],"mappings":"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"}
