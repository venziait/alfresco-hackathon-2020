{"version":3,"file":"search-highlight.umd.js.map","sources":["ng://search-highlight/lib/search-highlight.service.ts","ng://search-highlight/lib/components/search-highlight/search-highlight.component.ts","ng://search-highlight/lib/adf.module.ts","ng://search-highlight/lib/search-highlight.module.ts"],"sourcesContent":["/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchHighlightService {\n\n  constructor() {}\n  \n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, OnInit, Input, ViewEncapsulation, OnDestroy, TemplateRef } from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\n\nimport { takeUntil } from 'rxjs/operators';\nimport { MinimalNodeEntity } from '@alfresco/js-api';\nimport { Store } from '@ngrx/store';\nimport { Router } from '@angular/router';\nimport { ViewNodeAction, NavigateToFolder } from '@alfresco/aca-shared/store';\n\n\n@Component({\n  selector: 'aca-search-results-row-highlight',\n  encapsulation: ViewEncapsulation.None,\n  templateUrl: './search-highlight.component.html',\n  styleUrls: ['./search-highlight.component.scss']\n})\nexport class SearchHighlightComponent implements OnInit, OnDestroy {\n\n  @Input()\n  context: any;\n\n  @Input()\n  locationField: TemplateRef<any>;\n\n  private node: MinimalNodeEntity;\n  private onDestroy$ = new Subject<boolean>();\n  name$ = new BehaviorSubject<string>('');\n  title$ = new BehaviorSubject<string>('');\n  highlight: [];\n\n  constructor(\n    private store: Store<any>,\n    private alfrescoApiService: AlfrescoApiService,\n    private router: Router\n    ) { }\n\n  ngOnInit() {\n    \n    this.updateValues();\n\n    this.alfrescoApiService.nodeUpdated\n      .pipe(takeUntil(this.onDestroy$))\n      .subscribe((node: any) => {\n        const row = this.context.row;\n        if (row) {\n          const { entry } = row.node;\n\n          if (entry.id === node.id) {\n            entry.name = node.name;\n            entry.properties = Object.assign({}, node.properties);\n            entry.search = Object.assign({}, node.search);\n            this.updateValues();\n          }\n        }\n      });\n  }\n\n  private updateValues() {\n\n    this.node = this.context.row.node;\n\n    const highlightAll = (this.node.entry['search'] && this.node.entry['search']['highlight']) ? this.node.entry['search']['highlight'] : [];\n\n    const { name, properties } = this.node.entry;\n    const title = properties ? properties['cm:title'] : '';\n\n    this.name$.next(name);\n\n    if (title !== name) {\n      this.title$.next(title ? `( ${title} )` : '');\n    }\n\n    highlightAll.forEach(elem => {\n      if (elem.field === \"cm:name\") {\n        this.name$.next(elem.snippets[0]);\n      }\n\n      if (elem.field === \"cm:title\" && title !== name) {\n        this.title$.next(`( ${elem.snippets[0]} )`);\n      }\n\n      if (elem.field === \"cm:content\") {\n        this.highlight = elem.snippets;\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.onDestroy$.next(true);\n    this.onDestroy$.complete();\n  }\n\n  get description(): string {\n    const { properties } = this.node.entry;\n    return properties ? properties['cm:description'] : '';\n  }\n\n  get modifiedAt(): Date {\n    return this.node.entry.modifiedAt;\n  }\n\n  get size(): number {\n    const { content } = this.node.entry;\n    return content ? content.sizeInBytes : null;\n  }\n\n  get user(): string {\n    return this.node.entry.modifiedByUser.displayName;\n  }\n\n  get isFile(): boolean {\n    return this.node.entry.isFile;\n  }\n\n  showPreview(event: MouseEvent) {\n    event.stopPropagation();\n    this.store.dispatch(\n      new ViewNodeAction(this.node.entry.id, { location: this.router.url })\n    );\n  }\n\n  navigate(event: MouseEvent) {\n    event.stopPropagation();\n    this.store.dispatch(new NavigateToFolder(this.node));\n  }\n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule } from \"@angular/core\";\n// ADF modules\nimport {\n  CoreModule,\n  PipeModule,\n  ToolbarModule,\n  DirectiveModule\n} from '@alfresco/adf-core';\n\nexport function modules() {\n  return [CoreModule, ToolbarModule, PipeModule, DirectiveModule];\n}\n\n@NgModule({\n  imports: modules(),\n  exports: modules()\n})\nexport class AdfModule {\n\n}\n","/*!\n * @license\n * Alfresco Example Content Application\n *\n * Copyright (C) 2005 - 2020 Alfresco Software Limited\n *\n * This file is part of the Alfresco Example Content Application.\n * If the software was purchased under a paid Alfresco license, the terms of\n * the paid license agreement will prevail.  Otherwise, the software is\n * provided under the following open source license terms:\n *\n * The Alfresco Example Content Application is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The Alfresco Example Content Application is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Alfresco. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { SearchHighlightComponent } from './components/search-highlight/search-highlight.component';\nimport { CommonModule } from '@angular/common';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { AdfModule } from './adf.module';\n\n@NgModule({\n  declarations: [SearchHighlightComponent],\n  imports: [CommonModule, BrowserModule, TranslateModule.forChild(), AdfModule],\n  exports: [SearchHighlightComponent],\n  entryComponents: [SearchHighlightComponent],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class SearchHighlightModule { }\n"],"names":["Injectable","store","router","Subject","BehaviorSubject","takeUntil","ViewNodeAction","NavigateToFolder","Component","ViewEncapsulation","Store","AlfrescoApiService","Router","Input","CoreModule","ToolbarModule","PipeModule","DirectiveModule","NgModule","CommonModule","BrowserModule","TranslateModule","CUSTOM_ELEMENTS_SCHEMA"],"mappings":"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"}
